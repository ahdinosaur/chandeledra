#!/bin/bash

TARGET="armv7-unknown-linux-gnueabihf"
IS_RELEASE=true
BONE_LOCATION="debian@192.168.7.2:bin"

# https://stackoverflow.com/a/90441
set -e
set -o pipefail

CROSS_ARGS="build --target ${TARGET} --features hal"
MODE="debug"

if [ ${IS_RELEASE} = true ]
then
  CROSS_ARGS="${CROSS_ARGS} --release"
  MODE="release"
fi

cross ${CROSS_ARGS}

scp target/${TARGET}/${MODE}/controller-app ${BONE_LOCATION}
